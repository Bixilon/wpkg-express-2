var AppActionScriptsChartsView=AppActionScriptsChartsView||{};(function(c){function d(){c("#chartListMessages .alert").addClass("hidden")}function b(f){if(!f){return}var e=c("#msgChart"+f);if(e.length===0){return}d();e.removeClass("hidden")}function a(h,g,i){if(!h||!g||!i){return false}var e=false;var f={refType:g,refId:i};c.ajax({url:h,async:false,method:"POST",dataType:"json",data:f,global:false,success:function(j){if(!j){e={};return}e=j}});return e}AppActionScriptsChartsView.updateChart=function(){var j=c("#chart-wpkg");if(!j){b("Error");return}var k=true;var h=false;var q=j.data("chart-ref-type");var g=j.data("chart-ref-id");var e=j.data("chart-url");var m=j.data("chart-type");if(!m){m="doughnut"}var f=j.data("chart-title");if(!f){f="";k=false}var n=j.data("chart-click-url");var i=a(e,q,g);if(i===false){b("Error");h=true}else{if(i.length===0){b("NoData");h=true}else{d()}}if(h){j.remove();return}var p={};var o=j.get(0).getContext("2d");var l=new Chart(o,{type:m,data:i,options:{title:{display:k,text:f}}},p);if(!n){return}j.off("click.AppActionScriptsChartsView").on("click.AppActionScriptsChartsView",function(y){var v=l.getElementsAtEvent(y);if(!v[0]){return false}var u=n.charAt(n.length-1);if((u!=="=")&&(u!=="/")){n+="/"}var x=v[0]["_chart"].config.data;var r=v[0]["_index"];var t=x.labels[r];var w=x.datasets[0].data[r];var s=n+t;window.open(s,"_blank");window.focus();return false})};return AppActionScriptsChartsView})(jQuery);$(function(){$(document).off("MainAppScripts:update.AppActionScriptsChartsView").on("MainAppScripts:update.AppActionScriptsChartsView",function(){AppActionScriptsChartsView.updateChart()})});